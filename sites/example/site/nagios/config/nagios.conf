<VirtualHost *:80>
    ScriptAlias /nagios/cgi-bin "/usr/lib/nagios/cgi"
    Alias /nagios "/usr/share/nagios"
    <Directory "/usr/lib/nagios/cgi">
        Options ExecCGI
        AllowOverride None
        Order allow, deny
        Allow from .example.org
        SetEnv REMOTE_USER guest
    </Directory>
    <Directory "/usr/share/nagios">
        Options None
        AllowOverride None
        Order allow, deny
        Allow from .example.org
        SetEnv REMOTE_USER guest
    </Directory>
</VirtualHost>
<VirtualHost 0.0.0.0:443>
    SSLEngine on
    SSLOptions +FakeBasicAuth
    SSLVerifyClient require
    SSLVerifyDepth 3
    ScriptAlias /nagios/cgi-bin "/usr/lib/nagios/cgi"
    Alias /nagios "/usr/share/nagios"
    <Directory "/usr/lib/nagios/cgi">
        Options ExecCGI
        AllowOverride None
        Order allow, deny
        Allow from .example.org
        AuthName "Nagios Access"
        AuthType Basic
        AuthUserFile /etc/nagios/htpasswd.users
        Require valid-user
    </Directory>
    <Directory "/usr/share/nagios">
        SSLRequireSSL
        SSLOptions +FakeBasicAuth
        SSLVerifyClient require
        SSLVerifyDepth 3
        Options None
        AllowOverride None
        Order allow, deny
        Allow from .example.org
        AuthName "Nagios Access"
        AuthType Basic
        AuthUserFile /etc/nagios/htpasswd.users
        Require valid-user
    </Directory>
</VirtualHost>
